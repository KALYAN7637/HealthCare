{"dataflow":{"dfKey":"88ea0e9d-8919-4144-aed4-ad5579b8cc69","name":"EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL","tags":null,"description":"Calculates derived fields for INSURANCE_CLAIMS_STG to populate PREMIUM_BUCKET, HIGH_RISK_FLAG, CUSTOMER_TENURE_CAT, CLAIM_SEVERITY_SCORE, AGE_GROUP, and TOTAL_CLAIM_VERIFIED in the INSURANCE_CLAIMS_MART table. Applies multiple transformation logic expressions defined for these target columns.","definition":"{\"name\":\"EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL\",\"description\":\"Calculates derived fields for INSURANCE_CLAIMS_STG to populate PREMIUM_BUCKET, HIGH_RISK_FLAG, CUSTOMER_TENURE_CAT, CLAIM_SEVERITY_SCORE, AGE_GROUP, and TOTAL_CLAIM_VERIFIED in the INSURANCE_CLAIMS_MART table. Applies multiple transformation logic expressions defined for these target columns.\",\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"\",\"excludeNotification\":\"Y\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"maskDataColumns\":\"\",\"componentId\":1,\"componentName\":\"src_EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL\",\"tableName\":\"src_EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL_1\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Oracle_sh\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"SELECT INSURANCE_CLAIMS_STG.SNO, CASE WHEN INSURANCE_CLAIMS_STG.POLICY_ANNUAL_PREMIUM \\u003c 600 THEN \\u0027LOW\\u0027 WHEN INSURANCE_CLAIMS_STG.POLICY_ANNUAL_PREMIUM BETWEEN 600 AND 1200 THEN \\u0027MID\\u0027 ELSE \\u0027HIGH\\u0027 END AS PREMIUM_BUCKET, CASE WHEN COALESCE(INSURANCE_CLAIMS_STG.WITNESSES,0) \\u003d 0 AND COALESCE(INSURANCE_CLAIMS_STG.BODILY_INJURIES,0) \\u003e 0 THEN 1 WHEN INSURANCE_CLAIMS_STG.AUTHORITIES_CONTACTED \\u003d \\u0027NONE\\u0027 AND INSURANCE_CLAIMS_STG.INCIDENT_SEVERITY \\u003d \\u0027MAJOR DAMAGE\\u0027 THEN 1 WHEN INSURANCE_CLAIMS_STG.INSURED_OCCUPATION IN (\\u0027UNEMPLOYED\\u0027,\\u0027SELF-EMPLOYED\\u0027) THEN 1 ELSE 0 END AS HIGH_RISK_FLAG, CASE WHEN INSURANCE_CLAIMS_STG.MONTHS_AS_CUSTOMER \\u003c 12 THEN \\u0027NEW\\u0027 WHEN INSURANCE_CLAIMS_STG.MONTHS_AS_CUSTOMER BETWEEN 12 AND 60 THEN \\u0027LOYAL\\u0027 ELSE \\u0027VETERAN\\u0027 END AS CUSTOMER_TENURE_CAT, COALESCE(INSURANCE_CLAIMS_STG.VEHICLE_CLAIM,0) * 0.4 AS CLAIM_SEVERITY_SCORE, CASE WHEN INSURANCE_CLAIMS_STG.AGE \\u003c 25 THEN \\u0027YOUNG\\u0027 WHEN INSURANCE_CLAIMS_STG.AGE BETWEEN 25 AND 50 THEN \\u0027ADULT\\u0027 ELSE \\u0027SENIOR\\u0027 END AS AGE_GROUP, (COALESCE(INSURANCE_CLAIMS_STG.INJURY_CLAIM,0) + COALESCE(INSURANCE_CLAIMS_STG.PROPERTY_CLAIM,0) + COALESCE(INSURANCE_CLAIMS_STG.VEHICLE_CLAIM,0)) AS TOTAL_CLAIM_VERIFIED FROM TESTDATA.INSURANCE_CLAIMS_STG\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"maskDataColumns\":\"\",\"componentId\":2,\"componentName\":\"tgt_EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL\",\"tableName\":\"tgt_EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL_2\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Snowflake\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"SELECT SNO, PREMIUM_BUCKET, HIGH_RISK_FLAG, CUSTOMER_TENURE_CAT, CLAIM_SEVERITY_SCORE, AGE_GROUP, TOTAL_CLAIM_VERIFIED FROM DGPOC.POC.INSURANCE_CLAIMS_MART\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"sourceDataFrame\":\"src_EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL_1\",\"targetDataFrame\":\"tgt_EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL_2\",\"mapping\":[{\"sourceColumn\":\"SNO\",\"sourceType\":\"NUMBER\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"NUMBER\",\"targetColumn\":\"SNO\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\",\"unique\":\"Y\",\"columnOrder\":0},{\"sourceColumn\":\"PREMIUM_BUCKET\",\"sourceType\":\"VARCHAR2\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"VARCHAR2\",\"targetColumn\":\"PREMIUM_BUCKET\",\"targetType\":\"VARCHAR\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"VARCHAR\",\"unique\":\"N\",\"columnOrder\":1},{\"sourceColumn\":\"HIGH_RISK_FLAG\",\"sourceType\":\"NUMBER\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"NUMBER\",\"targetColumn\":\"HIGH_RISK_FLAG\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\",\"unique\":\"N\",\"columnOrder\":2},{\"sourceColumn\":\"CUSTOMER_TENURE_CAT\",\"sourceType\":\"VARCHAR2\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"VARCHAR2\",\"targetColumn\":\"CUSTOMER_TENURE_CAT\",\"targetType\":\"VARCHAR\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"VARCHAR\",\"unique\":\"N\",\"columnOrder\":3},{\"sourceColumn\":\"CLAIM_SEVERITY_SCORE\",\"sourceType\":\"NUMBER\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"NUMBER\",\"targetColumn\":\"CLAIM_SEVERITY_SCORE\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\",\"unique\":\"N\",\"columnOrder\":4},{\"sourceColumn\":\"AGE_GROUP\",\"sourceType\":\"VARCHAR2\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"VARCHAR2\",\"targetColumn\":\"AGE_GROUP\",\"targetType\":\"VARCHAR\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"VARCHAR\",\"unique\":\"N\",\"columnOrder\":5},{\"sourceColumn\":\"TOTAL_CLAIM_VERIFIED\",\"sourceType\":\"NUMBER\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"NUMBER\",\"targetColumn\":\"TOTAL_CLAIM_VERIFIED\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\",\"unique\":\"N\",\"columnOrder\":6}],\"onlyInA\":\"Y\",\"onlyInB\":\"Y\",\"difference\":\"Y\",\"enableTrim\":\"N\",\"replaceNull\":\"N\",\"autoDataTypeConversion\":\"Y\",\"columnDifferencesCount\":\"Y\",\"ignoreCase\":\"N\",\"hasDuplicates\":\"N\",\"subDataFrames\":[{\"subDataFrameName\":\"_Matched\",\"type\":\"Matched\"},{\"subDataFrameName\":\"_Source_Duplicate\",\"type\":\"Duplicates In A\"},{\"subDataFrameName\":\"_Target_Duplicate\",\"type\":\"Duplicates In B\"},{\"subDataFrameName\":\"_Difference\",\"type\":\"Difference\"},{\"subDataFrameName\":\"_OnlySource\",\"type\":\"Only In A\"},{\"subDataFrameName\":\"_OnlyTarget\",\"type\":\"Only In B\"},{\"subDataFrameName\":\"_Column_Difference\",\"type\":\"Difference Column\"}],\"onlyInAThresholdUnit\":\"number\",\"onlyInAThreshold\":0.0,\"onlyInBThresholdUnit\":\"number\",\"onlyInBThreshold\":0.0,\"differencesSourceThresholdUnit\":\"number\",\"differencesSourceThreshold\":0.0,\"differencesTargetThresholdUnit\":\"number\",\"differencesTargetThreshold\":0.0,\"passIfEmpty\":\"N\",\"hideDatasets\":\"N\",\"componentId\":3,\"componentName\":\"dc_EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL\",\"tableName\":\"dc_EXPRESSION_PREMIUM_BUCKET_HIGH_RISK_FLAG_CUSTOMER_TENURE_CAT_CLAIM_SEVERITY_SCORE_AGE_GROUP_TOTAL_CL\",\"category\":\"Data Reconciliation\",\"componentType\":\"Data Compare\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[1,2],\"options\":{},\"className\":\"com.datagaps.dataflow.models.DataCompareComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 1000\",\"defValueInBatchMode\":\"limit 10\"}]","version":3,"maxComponentId":3,"livyOptions":null,"isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow/Mapping Dataflows","workSchemaName":null,"diagramSchema":"{\"isCustom\":false,\"diagramDef\":[]}"},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[],"filterDatasetMappings":[],"referenceDatasets":null}
{"dataflow":{"dfKey":"06df742d-a2af-408a-bb5a-120acc7cb48b","name":"Emg_Patients","tags":null,"description":null,"definition":"{\"name\":\"Emg_Patients\",\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"\",\"excludeNotification\":\"Y\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"Y\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"maskDataColumns\":\"\",\"componentId\":2,\"componentName\":\"lab_results\",\"tableName\":\"lab_results\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Cloud_Oracle\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select RESULT_ID,PATIENT_ID,VISIT_ID,TEST_CODE,TEST_NAME,RESULT_VALUE,UNIT,REFERENCE_RANGE,RESULT_DATE,RESULT_STATUS,COMMENTS from SH.LAB_RESULTS\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"Y\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"maskDataColumns\":\"\",\"componentId\":3,\"componentName\":\"patients\",\"tableName\":\"patients\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Cloud_Oracle\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select PATIENT_ID,FIRST_NAME,LAST_NAME,GENDER,DATE_OF_BIRTH,PHONE_NUMBER,EMAIL,ADDRESS_LINE1,ADDRESS_LINE2,CITY,STATE,ZIP_CODE,CREATED_AT from SH.PATIENTS\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"Y\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"maskDataColumns\":\"[]\",\"componentId\":5,\"componentName\":\"visits\",\"tableName\":\"visits\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Cloud_Oracle\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select VISIT_ID,PATIENT_ID,VISIT_DATE,VISIT_TYPE,PROVIDER_ID,REASON_FOR_VISIT,CREATED_AT from SH.VISITS\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"Y\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"maskDataColumns\":\"\",\"componentId\":6,\"componentName\":\"providers\",\"tableName\":\"providers\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Cloud_Oracle\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select PROVIDER_ID,PROVIDER_NAME,SPECIALTY,PHONE_NUMBER,EMAIL,CREATED_AT from SH.PROVIDERS\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"Y\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"maskDataColumns\":\"[]\",\"componentId\":10,\"componentName\":\"tgr emg_patients\",\"tableName\":\"tgr_emg_patients\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Oracle Cloud\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select RESULT_ID,PATIENT_ID,VISIT_ID,TEST_CODE,TEST_NAME,RESULT_VALUE_NUM,LOWER_LIMIT,UPPER_LIMIT,IS_CRITICAL,RESULT_DATE,PATIENT_NAME,PROVIDER_NAME,VISIT_TYPE,CREATED_AT from SH.PATIENT_EMERGENCY_CASES where TEST_CODE\\u003d\\u0027$[TEST_CODE]\\u0027\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":7,\"componentName\":\"src emg_patients\",\"tableName\":\"src_emg_patients\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[6,2,3,5],\"options\":{\"dbTable\":\"SELECT\\r\\n    lr.result_id,\\r\\n    lr.patient_id,\\r\\n    lr.visit_id,\\r\\n    lr.test_code,\\r\\n    lr.test_name,\\r\\n    p.address_line1,\\r\\n    p.address_line2,\\r\\n    p.city,\\r\\n\\r\\n    CAST(regexp_replace(lr.result_value, \\u0027[^0-9\\\\\\\\.]\\u0027, \\u0027\\u0027) AS DOUBLE) AS result_value_num,\\r\\n\\r\\n    CAST(\\r\\n        regexp_extract(\\r\\n            regexp_replace(lr.reference_range, \\u0027\\\\\\\\s\\u0027, \\u0027\\u0027),\\r\\n            \\u0027([0-9]+)[-–]([0-9]+)\\u0027,\\r\\n            1\\r\\n        ) AS DOUBLE\\r\\n    ) AS lower_limit,\\r\\n\\r\\n    CAST(\\r\\n        regexp_extract(\\r\\n            regexp_replace(lr.reference_range, \\u0027\\\\\\\\s\\u0027, \\u0027\\u0027),\\r\\n            \\u0027([0-9]+)[-–]([0-9]+)\\u0027,\\r\\n            2\\r\\n        ) AS DOUBLE\\r\\n    ) AS upper_limit,\\r\\n\\r\\n    CASE\\r\\n        WHEN CAST(regexp_replace(lr.result_value, \\u0027[^0-9\\\\\\\\.]\\u0027, \\u0027\\u0027) AS DOUBLE) \\u003c\\r\\n             CAST(regexp_extract(regexp_replace(lr.reference_range, \\u0027\\\\\\\\s\\u0027, \\u0027\\u0027), \\u0027([0-9]+)[-–]([0-9]+)\\u0027, 1) AS DOUBLE)\\r\\n        THEN \\u0027CRITICAL\\u0027\\r\\n\\r\\n        WHEN CAST(regexp_replace(lr.result_value, \\u0027[^0-9\\\\\\\\.]\\u0027, \\u0027\\u0027) AS DOUBLE) \\u003e\\r\\n             CAST(regexp_extract(regexp_replace(lr.reference_range, \\u0027\\\\\\\\s\\u0027, \\u0027\\u0027), \\u0027([0-9]+)[-–]([0-9]+)\\u0027, 2) AS DOUBLE)\\r\\n        THEN \\u0027CRITICAL\\u0027\\r\\n\\r\\n        ELSE \\u0027NORMAL\\u0027\\r\\n    END AS is_critical,\\r\\n\\r\\n    lr.result_date,\\r\\n\\r\\n    CONCAT(p.first_name, \\u0027 \\u0027, p.last_name) AS patient_name,\\r\\n    pr.provider_name,\\r\\n    v.visit_type\\r\\n\\r\\nFROM lab_results lr\\r\\nLEFT JOIN patients p     ON lr.patient_id \\u003d p.patient_id\\r\\nLEFT JOIN visits v       ON lr.visit_id \\u003d v.visit_id\\r\\nLEFT JOIN providers pr   ON v.provider_id \\u003d pr.provider_id\\r\\nwhere v.visit_type\\u003d\\u0027Emergency\\u0027\\r\\nand p.phone_number is not null\\r\\nand pr.provider_name is not null\\r\\nand lr.test_code\\u003d \\\"$[TEST_CODE]\\\"\\r\\n\"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"sourceDataFrame\":\"src_emg_patients\",\"targetDataFrame\":\"tgr_emg_patients\",\"mapping\":[{\"sourceColumn\":\"result_id\",\"sourceType\":\"decimal(38,10)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,10)\",\"targetColumn\":\"RESULT_ID\",\"targetType\":\"decimal(38,10)\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"decimal(38,10)\",\"unique\":\"Y\",\"upperThreshold\":0.0,\"lowerThreshold\":0.0,\"thresholdUnit\":\"\",\"hasThreshold\":\"N\"},{\"sourceColumn\":\"patient_id\",\"sourceType\":\"decimal(38,10)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,10)\",\"targetColumn\":\"PATIENT_ID\",\"targetType\":\"decimal(38,10)\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"decimal(38,10)\",\"unique\":\"N\",\"upperThreshold\":0.0,\"lowerThreshold\":0.0,\"thresholdUnit\":\"\",\"hasThreshold\":\"N\"},{\"sourceColumn\":\"visit_id\",\"sourceType\":\"decimal(38,10)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,10)\",\"targetColumn\":\"VISIT_ID\",\"targetType\":\"decimal(38,10)\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"decimal(38,10)\",\"unique\":\"N\",\"upperThreshold\":0.0,\"lowerThreshold\":0.0,\"thresholdUnit\":\"\",\"hasThreshold\":\"N\"},{\"sourceColumn\":\"test_code\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"TEST_CODE\",\"targetType\":\"string\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"string\",\"unique\":\"N\",\"upperThreshold\":0.0,\"lowerThreshold\":0.0,\"thresholdUnit\":\"\",\"hasThreshold\":\"N\"},{\"sourceColumn\":\"test_name\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"TEST_NAME\",\"targetType\":\"string\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"string\",\"unique\":\"N\",\"upperThreshold\":0.0,\"lowerThreshold\":0.0,\"thresholdUnit\":\"\",\"hasThreshold\":\"N\"},{\"sourceColumn\":\"result_value_num\",\"sourceType\":\"double\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"double\",\"targetColumn\":\"RESULT_VALUE_NUM\",\"targetType\":\"decimal(38,10)\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"decimal(38,10)\",\"unique\":\"N\"},{\"sourceColumn\":\"lower_limit\",\"sourceType\":\"double\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"double\",\"targetColumn\":\"LOWER_LIMIT\",\"targetType\":\"decimal(38,10)\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"decimal(38,10)\",\"unique\":\"N\"},{\"sourceColumn\":\"upper_limit\",\"sourceType\":\"double\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"double\",\"targetColumn\":\"UPPER_LIMIT\",\"targetType\":\"decimal(38,10)\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"decimal(38,10)\",\"unique\":\"N\"},{\"sourceColumn\":\"is_critical\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_CRITICAL\",\"targetType\":\"string\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"string\",\"unique\":\"N\"},{\"sourceColumn\":\"result_date\",\"sourceType\":\"timestamp\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"RESULT_DATE\",\"targetType\":\"timestamp\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"timestamp\",\"unique\":\"N\"},{\"sourceColumn\":\"patient_name\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"PATIENT_NAME\",\"targetType\":\"string\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"string\",\"unique\":\"N\"},{\"sourceColumn\":\"provider_name\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"PROVIDER_NAME\",\"targetType\":\"string\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"string\",\"unique\":\"N\"},{\"sourceColumn\":\"visit_type\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"VISIT_TYPE\",\"targetType\":\"string\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"string\",\"unique\":\"N\"}],\"onlyInA\":\"Y\",\"onlyInB\":\"Y\",\"difference\":\"Y\",\"enableTrim\":\"N\",\"replaceNull\":\"N\",\"autoDataTypeConversion\":\"Y\",\"columnDifferencesCount\":\"N\",\"ignoreCase\":\"N\",\"hasDuplicates\":\"N\",\"subDataFrames\":[{\"subDataFrameName\":\"_Matched\",\"type\":\"Matched\"},{\"subDataFrameName\":\"_Source_Duplicate\",\"type\":\"Duplicates In A\"},{\"subDataFrameName\":\"_Target_Duplicate\",\"type\":\"Duplicates In B\"},{\"subDataFrameName\":\"_Difference\",\"type\":\"Difference\"},{\"subDataFrameName\":\"_OnlySource\",\"type\":\"Only In A\"},{\"subDataFrameName\":\"_OnlyTarget\",\"type\":\"Only In B\"}],\"onlyInAThresholdUnit\":\"number\",\"onlyInAThreshold\":0.0,\"onlyInBThresholdUnit\":\"number\",\"onlyInBThreshold\":0.0,\"differencesSourceThresholdUnit\":\"number\",\"differencesSourceThreshold\":0.0,\"differencesTargetThresholdUnit\":\"number\",\"differencesTargetThreshold\":0.0,\"passIfEmpty\":\"N\",\"hideDatasets\":\"Y\",\"componentId\":11,\"componentName\":\"Data Compare 11\",\"tableName\":\"Data_Compare_11\",\"category\":\"Data Reconciliation\",\"componentType\":\"Data Compare\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[10,7],\"options\":{},\"className\":\"com.datagaps.dataflow.models.DataCompareComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"type\":\"static\",\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"},{\"type\":\"static\",\"name\":\"TEST_CODE\",\"defValueInInteractiveMode\":\"GLU\",\"defValueInBatchMode\":\"GLU\"}]","version":3,"maxComponentId":15,"livyOptions":null,"isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow/Health Care","workSchemaName":null,"diagramSchema":"{\"isCustom\":false,\"diagramDef\":[]}"},"analysis":[],"datamodels":[],"tagDetails":[{"tagName":"Health Care","additinalInfo":"{\"colourCode\":\"#008000\"}"}],"dataCompares":[],"filterDatasetMappings":[],"referenceDatasets":null}